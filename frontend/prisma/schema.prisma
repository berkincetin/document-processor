// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model FileMetadata {
  id            String   @id @default(cuid())
  name          String
  sizeBytes     Int
  relativePath  String?
  lastModified  Int
  selectedAt    DateTime
  uploadedAt    DateTime?
  processedAt   DateTime?
  host          String
  status        String
  errorMessage  String?
  computerName  String?
  userName      String?
  userAgent     String?
  uploadDuration Int?
  processDuration Int?
  fileType      String?
  mimeType      String?
  checksum      String?
  retryCount    Int @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  logs          Log[]

  @@index([status])
  @@index([host])
  @@index([selectedAt])
  @@index([uploadedAt])
}

model Log {
  id        String   @id @default(cuid())
  message   String
  level     String
  timestamp DateTime @default(now())
  fileId    String?
  
  file      FileMetadata? @relation(fields: [fileId], references: [id])

  @@index([timestamp])
  @@index([level])
  @@index([fileId])
}
